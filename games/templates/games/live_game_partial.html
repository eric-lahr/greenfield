{# games/templates/games/live\_game\_partial.html #}

<div id="live-area">
  <div class="row">
    <!-- LEFT 2/3: Scoreboard + Defense & Baserunning -->
    <div class="col-md-8">
      {# Scoreboard #}
      <table class="table table-sm">
        <thead>
          <tr>
            <th></th>
            {% for inning in innings %}
              <th>{{ inning }}</th>
            {% endfor %}
            <th>R</th><th>H</th><th>E</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>{{ session.game.away_team }}</th>
            {% for run in away_scores %}<td>{{ run }}</td>{% endfor %}
            <td>{{ away_totals.runs }}</td>
            <td>{{ away_totals.hits }}</td>
            <td>{{ away_totals.errors }}</td>
          </tr>
          <tr>
            <th>{{ session.game.home_team }}</th>
            {% for run in home_scores %}<td>{{ run }}</td>{% endfor %}
            <td>{{ home_totals.runs }}</td>
            <td>{{ home_totals.hits }}</td>
            <td>{{ home_totals.errors }}</td>
          </tr>
        </tbody>
      </table>

```
  {# Combined Defense & Baserunning form #}
  <form
    id="runner-form"
    method="post"
    hx-post="{% url 'games:live_game' session.id %}"
    hx-target="#live-area"
    hx-swap="innerHTML"
  >
    {% csrf_token %}
    <div class="row mt-3">
      <!-- Defense (left third) -->
      <div class="col-md-6">
        <h6>Defense</h6>
        <div class="table-responsive">
          <table class="table table-sm align-middle">
            <thead>
              <tr>
                <th>Pos</th><th>Player</th><th>Rating</th>
                {% for code,label in defense_choices %}
                  <th class="text-center">{{ label }}</th>
                {% endfor %}
              </tr>
            </thead>
            <tbody>
              {% for spot in defense_spots %}
              <tr>
                <td>{{ spot.position }}</td>
                <td>{{ spot.player.last_name }}</td>
                <td>{{ spot.rating }}</td>
                {% for code,label in defense_choices %}
                  <td class="text-center">
                    <input class="form-check-input" type="radio"
                           name="defense_{{ spot.index }}"
                           value="{{ code }}">
                  </td>
                {% endfor %}
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

      <!-- Baserunners (middle third) -->
      <div class="col-md-6">
        <h6>Bases</h6>
        {% for base in bases %}
          <div class="mb-2">
            <strong>{{ base.name }}:</strong>
            {% if base.runner %}
              {{ base.runner.last_name }}
              {% for code,label in base_actions %}
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio"
                         name="base_{{ base.index }}"
                         value="{{ code }}"
                         id="base_{{ base.index }}_{{ code }}">
                  <label class="form-check-label"
                         for="base_{{ base.index }}_{{ code }}">
                    {{ label }}
                  </label>
                </div>
              {% endfor %}
            {% else %}
              <em>Empty</em>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </div>

    <button type="submit" class="btn btn-sm btn-primary mt-2">
      Apply Defense & Baserunning
    </button>
  </form>

</div> <!-- /.col-md-8 -->

<!-- RIGHT 1/3: Matchup & At-Bat Results -->
<div class="col-md-4">
  <div class="mb-2">
    <strong>
      {{ session.is_top|yesno:"Top,Bottom" }} of {{ session.inning }}
      &mdash; {{ session.outs }} {{ session.outs|pluralize:"out,outs" }}
    </strong>
    <a href="{% url 'games:game_stats' session.id %}"
       class="btn btn-info mt-1 w-100">
       View Game Stats
    </a>
  </div>

  <div class="card mb-2">
    <div class="card-header">{{ session.game.away_team }}</div>
    <div class="card-body">
      <h6 class="card-title">{{ away_player }}</h6>
      <p class="card-text">Rating: {{ away_rating }}</p>
    </div>
  </div>
  <div class="card mb-2">
    <div class="card-header">{{ session.game.home_team }}</div>
    <div class="card-body">
      <h6 class="card-title">{{ home_player }}</h6>
      <p class="card-text">Rating: {{ home_rating }}</p>
    </div>
  </div>

  {# At-Bat Form (includes defense & baserunning inputs) #}
  <form
    id="play-form"
    method="post"
    hx-post="{% url 'games:live_game' session.id %}"
    hx-target="#live-area"
    hx-swap="innerHTML"
    hx-include="#runner-form"
  >
    {% csrf_token %}
    <div class="btn-group flex-wrap">
      {% for code,label in play_choices %}
        <button type="submit"
                name="result" value="{{ code }}"
                class="btn btn-outline-primary m-1 flex-fill">
          {{ label }}
        </button>
      {% endfor %}
      <button type="submit" name="result" value="FC"
              class="btn btn-outline-secondary m-1 flex-fill">
        FC
      </button>
      <button type="submit" name="result" value="E"
              class="btn btn-outline-danger m-1 flex-fill">
        Error
      </button>
    </div>
  </form>

  <a href="{% url 'games:substitute' session.id %}"
     class="btn btn-secondary mt-2 w-100">Substitute</a>
  <a href="{% url 'games:live_undo' session.id %}"
     class="btn btn-outline-danger mt-1 w-100">Undo Last Play</a>
  <a href="{% url 'games:setup_game' %}"
     class="btn btn-danger mt-1 w-100">Start New Game</a>
</div>
```

  </div>
</div>
