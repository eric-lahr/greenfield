{% load filters %}
{% block content %}

<h2>Select a Team</h2>

<form method="get" class="mb-4">
  <div class="form-group">
    <select name="team_id" class="form-control" onchange="this.form.submit()">
      <option value="">-- Select a team --</option>
      {% for team in teams %}
        <option value="{{ team.serial }}" {% if team.serial|stringformat:"s" == selected_team_id %}selected{% endif %}>
          {{ team.first_name }} {{ team.team_name }}
        </option>
      {% endfor %}
    </select>
  </div>
</form>

{% if players %}
  <h3>{{ teams|get_team_name:selected_team_id }}</h3>
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th>Name</th>
        <th>Year</th>
        <th>Bats</th>
        <th>Throws</th>
        <th>Offense</th>
        <th>Defense</th>
        <th>Pitching</th>
      </tr>
    </thead>
    <tbody>
      {% for player in players %}
        <tr>
          <td>{{ player.first_name }} {{ player.last_name }}</td>
          <td>{{ player.year }}</td>
          <td>{{ player.bats }}</td>
          <td>{{ player.throws }}</td>
          <td>{{ player.offense }}</td>
          <td>
            {% for rating in player_ratings|get:player.id %}
              {{ rating.position.name }}: {{ rating.rating }}{% if not forloop.last %}, {% endif %}
            {% empty %}
              <i>No positions</i>
            {% endfor %}
          </td>          
          {% if player.pitching %}
            <td>{{ player.pitching }}</td>
          {% endif %}
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endif %}

{% endblock %}
